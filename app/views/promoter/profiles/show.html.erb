<div class="container">
  <div class="row">
    <div class="span12">
      <% if user_signed_in? && current_user.profile == @profile %>
        <%= link_to "Show Editor", "/editor" + request.path, id: "edit_link", class: "btn btn-large" %>
        <%= link_to "Change Settings", edit_promoter_profile_path(@profile), class: "btn btn-large" %>
        <%= link_to "Public Profile", profile_path(@profile), class: "btn btn-large" %>
      <% elsif user_signed_in? && current_user.promoters.where("event_id IS NULL").include?(@profile.user) %>
        <button class="btn btn-success">Tour Requested <i class="icon-check icon-white"></i></button>
      <% elsif user_signed_in? %>
        <%= link_to "Request Tour", requests_path(promoter_id: @profile.user_id), class: "btn btn-large", method: :post %>
      <% end %>
    </div>
  </div>
  <section class="section-box">
    <div class="row">
      <div class="label-box">Promoter Info</div>
      <div id="promoter-pic" class="span2">
        <% if @profile.image? %>
          <%= filepicker_image_tag @profile.image, w: 200, h: 200, fit: 'crop' %>
        <% else %>
          <img src="//placehold.it/200" class="img-polaroid">
        <% end %>
        <div align="center">
          <%= link_to "Change Image", edit_promoter_profile_path(@profile) %>
        </div>
      </div>
      <div class="span3 offset2" align="center">
        <div class="page-header">
          <h2>
            <div id="name" data-mercury="full">
              <%= @profile.promoter_name || "Promoter Name" %>
            </div>
          </h2>
        </div>
        <h4><p class="muted">
          <div id="location">
            <% if @profile.location %>
              <%= @profile.location.city %>, <%= @profile.location.country %>
            <% else %>
              location not set
            <% end %>
          </div>
        </p></h4>
      </div>
      <div class="span2 offset2">
        <fieldset>
          <dl align="center">
            <dt>Status</dt>
            <dd><span class="badge badge" style="font-size:14px;"><%= @profile.state %></span></dd>
            <dt>Tour Requests</dt>
            <dd> <span class="badge"><%= @requests.count || "None currently" %></span></dd>
          </dl>
        </fieldset>
      </div>
    </div>
  </section>

  <section id="promoter-stats" class="section-box">
    <div class="label-box">Promoter Stats</div>
      <div class="row">
        <div class="span4">
          <fieldset>
            <legend align="center">General Info</legend>
            <dl class="dl-horizontal">
              <dt>Joined: </dt>
              <dd><%= time_ago_in_words(@user.confirmed_at) %> ago</dd>
              <dt>Availability: </dt>
              <dd id="available" data-mercury="full"><%= @profile.available %></dd>
              <dt>Fee: </dt>
              <dd id="fee" data-mercury="full"><%= @profile.fee %></dd>
            </dl>
          </fieldset>
        </div>
        <div class="span4">
          <fieldset>
            <legend align="center">Event History</legend>
          <dl class="dl-horizontal">
            <dt>Total: </dt>
            <dd><%= @profile.events.count || 0 %></dd>
            <dt>Successful: </dt>
            <dd> 0 </dd>
            <dt>Upcoming: </dt>
            <dd><%= @profile.events.count || 0 %></dd>
          </dl>
          </fieldset>
        </div>
        <div class="span3">
          <fieldset>
            <legend align="center">Event Average</legend>
          <dl class="dl-horizontal">
            <dt>Funding: </dt>
            <dd><%= number_to_currency(1000) %></dd>
            <dt>Attendance: </dt>
            <dd>100</dd>
            <dt>Ticket Price: </dt>
            <dd><%= number_to_currency(10) %></dd>
          </dl>
          </fieldset>
        </div>

      </div>
      <div class="row">
        <div class="span2">
          <!-- span>
            <button class="btn btn-primary btn-block">Full History</button>
          </span> -->
        </div>
      </div>
  </section>

  <section id="tour-info" class="section-box">
    <div class="row">
      <div class="label-box">Tour Info</div>
      <div class="span5">
        <div class="tabbable tabs-below">
          <ul class="nav nav-tabs">
            <li class="active"><a href="#about" data-toggle="tab">About Me</a></li>
            <li><a href="#equipment" data-toggle="tab">Equipment</a></li>
            <li><a href="#venues" data-toggle="tab">Venues</a></li>
            <li><a href="#travel" data-toggle="tab">Getting here</a></li>
            <li><a href="#accomodation" data-toggle="tab">Accomodation</a></li>
            <li><a href="#history" data-toggle="tab">Current & Past Shows</a></li>
          </ul>
        </div>
        <div class="tab-content">
          <div class="tab-pane active tour-content" id="about" data-mercury="full">
            <% if @profile.about? %>
              <%= raw @profile.about %>
            <% else %>
              <p>This is where you can talk about your attitude and commitment to music and musicians. Why do you want to put on shows? What do you hope to get it out of it, what motivates you?</p>

              <p>Have you any visible presence on the web that shows your commitment to music as an artform? If so what is it, does it bring people together to appreciate music? Perhaps you have a radio show or a music blog? Perhaps you are an artist yourself?</p>

              <p>Bearing in mind what you say above you should tell artists if it isn't obvious already where they can go to watch, listen or read about you. You can read my blog for instance at <a href="//seocahill.com">seocahill.com</a>, listen to seocahill's playlists at Grooveshark or google my band, Crete Boom. </p>

              <p> How you pick your bands is important too. Do you prefer to pick artists yourself in your own time, or are you open to persuasion? Should artists contact you for a show? Do you have certain prerequisites?
              Ultimately this section if for everything and anything you think might interest an artist that doesn't fit into the other sections.
              </p>
              <p lead><%= @user.name %></p>
            <% end %>
          </div>
          <div class="tab-pane" id="equipment" data-mercury="full">
            <% if @profile.equipment? %>
              <%= raw @profile.equipment %>
            <% else %>
              <p>What sort of bands do you cater for? Can you hand large ensembles with specific needs equipment wise? If so will this cost, do you borrow, how do you source music gear?</p>
              <p>A lot of bands for smaller shows will be traveling with light, instruments only. They may also tailor the size of the touring band based on what the promoter can offer.</p>
            <% end %>
          </div>
          <div class="tab-pane" id="venues" data-mercury="full">
            <% if @profile.venues? %>
              <%= raw @profile.venues %>
            <% else %>
              <p>Tell us about the venue/ venues you use. Have you played them yourself? Do they book late shows? What are they, your house, a barn, a club? If links exist then link them and don't forget to puts pics and/or video in the media section opposite</p>
              <p>There's also the technical side of it, backlines, sound, engineers, whatever you think is relevant.</p>
              <p>If you're using a music club we expect them to pay up you based on ticket sales and likely bar takings. We also expect them to allow some kind of rider for the artist, whatever way they want to work it.</p>
            <% end %>
          </div>
          <div class="tab-pane" id="travel" data-mercury="full">
            <% if @profile.travel? %>
              <%= raw @profile.travel %>
            <% else %>
              <p>General advice about airports and ground transport is essential, especially when trying to work out a budget for the show.</p>
              <p>Which airlines to use, is there a cheap time to come to your city, general tips and hints about hauling gear or not? You should know all this from experience but the artist probably won't.</p>
              <p>Another important consideration for international artists is the visa / immigration situation.</p>
            <% end %>
          </div>
          <div class="tab-pane" id="accomodation" data-mercury="full">
            <% if @profile.accomodation? %>
              <%= raw @profile.accomodation %>
            <% else %>
              <p>We should aim slightly higher than couchsurf but as long as you offer some kind of definite accomodation or offer to organize it than good enough. Couches, hostels or hotels, free or priced into the show, the follow throught is what's important.</p>
              <p> Leaving bands roofless after a show or any other music industry type behaviour will not be tolerated!</p>
            <% end %>
          </div>
          <div class="tab-pane" id="history">
            <p>Artists will like to check out your activity stream if for no other reason to see if the dates they are looking at are available</p>
            <table class="table table-striped">
              <thead>
                <tr>
                  <th>Artist</th>
                  <th>Venue</th>
                  <th>Date</th>
                  <th></th>
                </tr>
              </thead>
              <tbody>
                <% @events.each do |event| %>
                <tr>
                  <td><%= event.artist %></td>
                  <td><%= event.venue %></td>
                  <td><%= time_tag event.date %></td>
                  <td><%= link_to "Details", event_path(event) %></td>
                </tr>
                <% end %>
              </tbody>
            </table>
          </div>
        </div>
      </div>
      <div class="span6" id="promoter-media" align="center">
        <h5>Youtube, vimeo, soundcloud or images here.</h5>
        <div id="media">
          <%= @profile.promoter_media %>
        </div>
        <br>
        <div><%= @profile.promoter_media_html || image_tag("//quickimage.it/460x340&text=Media") %></div>
      </div>
    </div>
  </section>
</div>